---
title: "Lab 02 - Plastic waste"
author: "David Marx-Lemieux"
date: ""
output: github_document
---

## Chargement des packages et des données

```{r load-packages, message=FALSE}
library(tidyverse) 
```

```{r load-data, message=FALSE}
plastic_waste <- read_csv("data/plastic-waste.csv")
```

```{r - voir la table de donnée}
glimpse(plastic_waste)

```

Commençons par filtrer les données pour retirer le point représenté par Trinité et Tobago (TTO) qui est un outlier.

```{r filter-data, message=FALSE}
plastic_waste %>%
  filter(plastic_waste_per_cap < 3.5)
```
# nombre de ligne

```{r voir-le-nombre-de-ligne}
nrow(plastic_waste)
```

# visualisation des données par un histogramme
```{r distribution-des-donnees}
ggplot(data = plastic_waste, aes(x = plastic_waste_per_cap)) +
  geom_histogram(binwidth = 0.2)
```

# identifier le pays "abberant"
```{r identifier-pays-abberant}
plastic_waste %>%
  filter(plastic_waste_per_cap > 3.5)
```

## Exercices

### Exercise 1

```{r plastic-waste-continent}
ggplot(plastic_waste %>%
      filter(plastic_waste_per_cap < 3.5), aes(x = plastic_waste_per_cap))+
  geom_histogram(binwidth = 0.18)+
  facet_wrap(~ continent, ncol = 3)+
  labs(title = "Nombre de pays en fonction de la quantité de déchet par habitant (Kg/jour), selon le continent")
```

La quantité de déchet par habitant est représentée par l'axe des X. De ce fait, plus on s'éloigne de l'origine, plus les pays consomment des déchets. L'axe des Y représente le nombre de pays. On constate que seul quelques pays d'Amérique du Nord et d'Asie ont des moyennes de consommations de déchets par habitant plus élevées que 0,7 kg/jour. Quelques pays d'Europe et d'Amérique du Sud les suient de près. L'Afrique, avec le continent avec le plus grand nombre de pays près de l'origine, donc qui pollue peu par le plastique. L'Asie est le second continent avec le plus de pays dans la tranche la plus faible pour la quantité de déchet par habitant.

### Exercise 2

```{r plastic-waste-density}
ggplot(plastic_waste %>%
         filter(plastic_waste_per_cap < 3.5), 
       aes(x = plastic_waste_per_cap,
           colour = continent, fill = continent))+
        geom_density(alpha = 0.6)+
      labs(title = "Densité du nombre de pays qui fonction de la quantité de déchet par habitant (Kg/jour), selon le continent")
           
```

La couleur et le remplissage (fill) se trouvent dans l'aes (estéthique) alors que la transparence (alpha) se retrouve dans geom_density, car la couleur et le remplissage sont des propriétés esthétiques, alors que la transparence sert à mettre en relief les différentes fonctions géométriques. La fonction "transparence" ne sert donc pas seulement l'esthétisme, mais aussi la géométrie elle-même.


### Exercise 3

Boxplot:

```{r plastic-waste-boxplot}
ggplot(plastic_waste %>%
         filter(plastic_waste_per_cap < 3.5), 
       aes(x = continent, y = plastic_waste_per_cap,
           colour = continent, fill = continent))+
        geom_boxplot(alpha = 0.6)+
      labs(title = "Génération de déchet (kg/jour) par habitant en fonction du continent")
           
```

Violin plot:

```{r plastic-waste-violin}
ggplot(plastic_waste %>%
      filter(plastic_waste_per_cap < 3.5), 
      aes(x = continent, y = plastic_waste_per_cap,
      colour = continent, fill = continent))+
    geom_violin(alpha = 0.6)+
    labs(title = "Génération de déchet (kg/jour) par habitant en fonction du continent")
```

Le diagramme en violon permet une meilleure précision dans la visualisation de la répartition des données dans un échantillons. Ici, par exemple, on voit qu'en Océanie, qu'il y a deux types d'échantillon. Les pays qui polluent moins et les pays qui polluent plus. Mais que dans tous les cas, le nombre de pays qui sont de faibles pollueurs, polluent plus que la majorité des pays d'Afrique et d'Asie. Les résultats sont beaucoup plus visuels et parlant que dans les boîtes à moustaches où l'on pourrait simplement dire, grâce à l'écart-type, qu'il y a plus de pays faiblement pollueur que très polueur.


### Exercise 4


```{r plastic-waste-mismanaged}
ggplot(plastic_waste %>% filter(plastic_waste_per_cap < 3.5),
       aes(x = plastic_waste_per_cap, y = mismanaged_plastic_waste_per_cap, 
           colour = continent))+
      geom_point()+
      geom_smooth(method=lm,
                  se=FALSE)+
      labs(title = "Quantité de déchets non gérés par les pays en fonction de la quantité de déchets produit par les habitant (kg/jour), à chaque jour")

      

```

source : http://www.cookbook-r.com/Graphs/Scatterplots_(ggplot2)/

À part les observations précédemment dit, comme le fait que les pays africains et asiatiques sont généralement les pays qui pollue le moins par habitant, on peut aussi remarqué que, généralement, ce sont ces derniers qui ont le plus de difficultés à gérer les déchets. On remarque aussi que les grands pollueurs sont ceux qui gèrent le mieux leurs déchets.

### Exercise 5

```{r plastic-waste-population-total}
ggplot(plastic_waste %>% filter(plastic_waste_per_cap < 3.5, total_pop < 1000000000),
      aes(x = total_pop, y = plastic_waste_per_cap))+
      geom_point()+
  geom_smooth(method=lm,
                  se=FALSE)+
      labs(title = "Quantité de déchets générés par les habitants d'un pays (kg/jour) en fonction de la population totale du pays")
```

```{r plastic-waste-population-coastal}
ggplot(plastic_waste %>% filter(plastic_waste_per_cap < 3.5),
       aes(x = coastal_pop, y = plastic_waste_per_cap))+
      geom_point()+
  geom_smooth(method=lm,
                  se=FALSE)+

      labs(title = "Quantité de déchets générés par les habitants d'un pays (kg/jour) en fonction de la population vivant sur les côtes")
```

Il ne semble pas avoir de forte corrélation, ni entre la population total et la quantité de polution générée, ni entre le nombre d'habitant côtiers et la quantité de déchets générées.

## Conclusion

Recréez la visualisation:

```{r créer ratio}
plastic_waste <- plastic_waste %>% 
  mutate(coastal_pop_prop = coastal_pop / total_pop)
```


```{r}
print(plastic_waste)
```

```{r recreate-viz}

ggplot(plastic_waste %>% filter(plastic_waste_per_cap < 3.5),
       aes(x = coastal_pop_prop, y = plastic_waste_per_cap))+
      geom_point(aes(color = continent))+
      geom_smooth()+
      labs(title = "Quantité de déchets plastiques vs Proportion de la population côtière",
          subtitle = "Selon le continent",
           x = "Proportion de la population côtière (Coastal / total population)", y = "Nombre de déchêts plastiques par habitants",
           colour = "Continent")

      

```
source : https://www.statology.org/ratios-in-r/
https://stackoverflow.com/questions/40600824/how-to-apply-geom-smooth-for-every-group


##  calcul médiane
```{r mediane}

mediane_dechets_par_continent <- plastic_waste %>%
  group_by(continent)%>%
    summarise(mediane_dechets = median(plastic_waste_per_cap, na.rm = TRUE))
```


```{r voir-mediane}
print(mediane_dechets_par_continent)
```

est-ce que le commit fonctionne ? ou pas ?